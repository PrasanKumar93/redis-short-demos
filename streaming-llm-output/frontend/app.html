<html>
  <head>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>

    <script>
      const socket = io("http://localhost:3000");

      function search() {
        const question = document.getElementById("question").value;
        const withoutStream = document.getElementById("withoutStream").checked;
        const outputDiv = document.getElementById("output");

        // Clear previous output
        outputDiv.innerHTML = "";

        if (withoutStream) {
          // Call the /askQuestionWithoutStream API
          fetch("http://localhost:3000/askQuestionWithoutStream", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              questionId: "1",
              topic: "Redis",
              topicQuestion: question,
            }),
          })
            .then((response) => response.json())
            .then((data) => {
              // Append API response to the DOM
              outputDiv.innerHTML = data.output;
            })
            .catch((error) => {
              console.error("Error:", error);
            });
        } else {
          // Use socket to emit the question
          socket.emit("askQuestion", {
            questionId: "1",
            topic: "Redis",
            topicQuestion: question,
          });
        }
      }

      socket.on("chunk", (chunk) => {
        const outputDiv = document.getElementById("output");
        console.log("Received chunk:", chunk);
        // Append chunk to the DOM
        outputDiv.innerHTML += chunk; //+ "<br/>";
      });
    </script>
  </head>
  <body>
    <label for="question">Question</label><br />
    <textarea id="question" name="question" rows="4" cols="50"></textarea><br />

    <input type="checkbox" id="withoutStream" name="withoutStream" />
    <label for="withoutStream">Without Stream</label><br />

    <button onclick="search()">Search</button>
    <div id="output"></div>
  </body>
</html>
